# CMIP6-distribution-analysis-Violine-graph
This Python script is designed to analyze, compare, and visualize precipitation data from climate model simulations under different future climate scenarios (SSP2-4.5 and SSP5-8.5) relative to observed data. It uses several scientific computing libraries including NumPy, Pandas, Xarray, Matplotlib, and Seaborn to process and visualize large climate datasets stored in NetCDF format.

The script begins by importing the necessary libraries and setting the working directory where the model and observational data files are located. It then defines a dictionary (files_vars) that contains the file paths and corresponding variable names for each dataset. These include observed precipitation data, historical model simulations (both raw and bias-corrected), and future projections for three time periods—Near (2020–2049), Mid (2041–2070), and Far (2071–2100)—under two different emission scenarios (SSP2-4.5 and SSP5-8.5). Each dataset is associated with a NetCDF file and a variable name (e.g., pr, pr_interp, pr_corrected) that specifies the precipitation data within the file.

Next, the script defines several custom functions to handle data loading and statistical analysis. The load_series() function uses Xarray to open each NetCDF file, extract the precipitation variable, average across spatial dimensions if necessary, and convert it into a time-series format using Pandas. The compute_metrics() and align_and_stats() functions compute various statistical performance metrics—R² (coefficient of determination), NSE (Nash-Sutcliffe Efficiency), MSE (Mean Squared Error), PBIAS (Percent Bias), and CORR (correlation coefficient)—to evaluate how closely model simulations match observed precipitation. Another function, monthly_match_and_stats(), compares model data against observed monthly means to account for seasonal variations in precipitation patterns.

The datasets are then loaded into memory, and each is sliced according to the specified time period (historical, near, mid, or far future). For each model dataset, the script computes the statistical metrics by comparing it to the observed dataset. The results are stored in a Pandas DataFrame (stats_df), which summarizes model performance for each dataset and time period.

For visualization, the script combines all time-series data into a single long-format DataFrame suitable for plotting. It uses Seaborn’s violin plot to display the distribution of precipitation values for each dataset, which helps to illustrate differences in data spread and central tendency among observed, raw, and bias-corrected model outputs. Overlayed point plots indicate the mean (red diamonds) and median (black circles) precipitation values for each dataset. Above each violin, the computed statistical metrics are annotated, providing a quick summary of model performance directly on the plot.

Finally, the figure is styled with consistent fonts (Times New Roman, bold), labeled with appropriate titles and axis names, and saved as a high-resolution image file (.jpg). Separate sections of the script repeat this process for the two different future climate scenarios—SSP2-4.5 and SSP5-8.5—producing comparative violin plots that show how precipitation distributions and model performance may change under different greenhouse gas pathways.

Overall, this script provides a comprehensive framework for evaluating and visualizing climate model precipitation outputs against observations, highlighting both statistical accuracy and changes in precipitation behavior across historical and future periods. It supports the thesis analysis by generating clear graphical representations and quantitative assessments of model reliability under varying climate scenarios.
